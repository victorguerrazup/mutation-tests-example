"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.switchCaseMutantPlacer = void 0;
const core_1 = require("@babel/core");
const util_1 = require("../util");
/**
 * Places the mutants with consequent of a SwitchCase node. Uses an if-statement to do so.
 * @example
 *  case 'foo':
 *    if (stryMutAct_9fa48(0)) {} else {
 *      stryCov_9fa48(0);
 *      console.log('bar');
 *      break;
 *   }
 */
exports.switchCaseMutantPlacer = {
    name: 'switchCaseMutantPlacer',
    canPlace(path) {
        return path.isSwitchCase();
    },
    place(path, appliedMutants) {
        let consequence = core_1.types.blockStatement([
            core_1.types.expressionStatement((0, util_1.mutationCoverageSequenceExpression)(appliedMutants.keys())),
            ...path.node.consequent,
        ]);
        for (const [mutant, appliedMutant] of appliedMutants) {
            consequence = core_1.types.ifStatement((0, util_1.mutantTestExpression)(mutant.id), core_1.types.blockStatement(appliedMutant.consequent), consequence);
        }
        path.replaceWith(core_1.types.switchCase(path.node.test, [consequence]));
    },
};
//# sourceMappingURL=switch-case-mutant-placer.js.map